\section{Introduction to Penetration Testing}
\label{sec:pentesting}

In the following chapter we are going to provide you the basic terminology of Penetration Testing ( or Pen Test for short ), as well as the common phases such test is composed of.

\subsection{Definition of penetration testing}
Looking around on the Web it is easy to search and find a definition for "\textit{Penetration Testing}", we will just report here two definitions.

\begin{definition}{(Wikipedia)}
A penetration test [...] is an authorized simulated cyberattack on a computer system, performed to evaluate the security of the system; this is not to be confused with a \textit{vulnerability assessment}. The test is performed to identify [...] vulnerabilities, including \textbf{the potential for unauthorized parties to gain access to the system's features and data} [...].
\end{definition}

\begin{definition}{(CloudFlare)}
Penetration testing (or pen testing) is a security exercise where a cyber-security expert attempts to find and exploit vulnerabilities in a computer system. The purpose of this simulated attack is to \textbf{identify any weak spots} in a systemâ€™s defenses which attackers could take advantage of.
\end{definition}

\subsection{The phases of penetration testing}
As explained by the definitions above, penetration testing involves a pentester, who needs to be authorized, trying to breach inside a company system in order to discover vulnerabilities that can be later be patched. In order for this to be a successful test some structure is needed: the pentester needs to be informed on the limits of the test, the appropriate amount of knowledge he needs to obtain about the company before starting the test and much more; on the other hand the company needs to be informed on what the pentester will do, what are the possible consequences of the test, which vulnerabilities have been found and exploited, how they got exploited and much more.\cite{online:guide-penetration-testing}
\newline
As we can see there is really a lot of information flowing in both directions; in order to make life easier to all the people involved some structure is needed, so we are going to present the typical phases in which penetration testing can be divided into.

\subsection{Scoping}
In this phase of penetration testing, also called \textbf{pre-engagement}, the pentester and the subject willing to perform this experiment define various aspects of the experiment; we will only report here the main ones.
\newline
The first thing to be defined concerns what is the actual goal of the test, in particoular the subject willing to be pentested defines its \textbf{expectations}, \textbf{targets} and \textbf{goals} of the experiment; this seems trivial but it is really useful for the pentester: having clear what the subject wants allows the pentester to define better the following phases of the experiment in order to actually satisfy client's expectations. In defining the phases of the experiment the pentester defines also what are the \textbf{tools} and \textbf{frameworks} that are going to be used.
\newline
As said at the very beginning the pentester must be explicitly authorized and such authorization needs to be provable, therefore usually a contract is signed: in this contract are also reported \textbf{legal implications} for both parties and it is usually fulfilled with one, or more, \textbf{non disclosure agreement}(s) which play a key role in preventing the vulnerabilities discovered to be made public without the subject eve knowing.
It is easy to imagine that the pentester can actually succeed in penetrating inside the system, therefore the subject must be ready with \textbf{backup and emergency plans} in order to respond to this risk, even if everything is happening in a controlled environment.
\newline
The last main thing to be decided in this phase is the definition of the test type; in particular the parties agree on the amount of information the pentester has regarding the software he is going to operate against. Typically three options are possible\cite{online:black-box-pt}:
\begin{itemize}
    \item \textbf{black box}: the pentester does not know anything about how the system works; this is usually the situation of average hackers;
    \item \textbf{white box}: the pentester does have the source code of the system, as well as the documentation;
    \item \textbf{gray box}: the pentester does have a level of knowledge and access comparable with the one possessed by a user, even with high privileges.
\end{itemize}

\subsection{Reconnaissance}
This is the phase in which the work of the pentester actually begins, trying to gather as much information as possible about the system he is going to attack; information gathering can be done using various methods and the most appropriate one, according to the system and on the agreements stipulated in the previous phase, is chosen by the pentester.
\newline
This phase is really important for the pentester: the more information are gathered the easier it is to proceed with the next phase; the pentester usually tries to gather:
\begin{itemize}
    \item \textbf{network information}, for example using Whois and DNS lookup;
    \item \textbf{External footprint}: the pentester looks for things normally available on the network, for example results of search queries, publicly available email addresses, etc.;
    \item \textbf{Internal footprint}: the pentester tries to gather information about the machine on which the service is running performing, for example, port scannings, packet sniffing, OS fingerprinting and so on.
\end{itemize}
As we can imagine such operations are time consuming and are case-dependant, therefore the pentester can use tools for trying to automate this process; one example of such tools is called \textbf{OSINT Framework}, which provides thorough list of open sources.

\subsection{Thread modelling and vulnerability identification}
After the pentester gathered information about the system this is the phase in which he/she starts to think about what to attack and how to actually do it.
First things first, the attacker needs to decide what to attack, which are the \textbf{assets} to be targeted; usually these assets do have a high value for the customer, otherwise it would make no sense the effort to protect them.
\newline
Once the list of assets is ready the pentester needs to \textbf{identify} a list of \textbf{vulnerabilities} for each asset in list in order to have a clear idea of what are the possible ways to breach in.
\newline
After the list of vulnerabilities for each asset is ready the pentester usually performs an enumeration of possible \textbf{threats} for every vulnerability; while doing this the pentester also checks if the vulnerability is actually exploitable or not: if the answer is no then the effort of trying to exploiting that particular one is not worth it.
\newline
The last thing the pentester usually does in this phase is identifying possible \textbf{attack vectors} for each threat and builds the payloads for exploiting that particoular vulnerability.
\newline
After all of this is done the pentester is ready for the next phase, but it is a good practice to share a \textbf{preliminary report} on vulnerabilities with the customer, so that he has a clear idea of what is going to happen in the immediate future.

\subsection{Exploiting}
Exploiting is the phase in which the pentester actually puts into play all the planning and the information he/she gathered in previous phases by actually trying to exploit vulnerabilities and accessing the system. In particular he is interested in analyzing how far an attacker would go after penetrating in the system while avoiding detection; of course the pentester does this while also respecting the constraints agreed with the customer.
\newline
The results of this phase will compse the majority of the final report that the pentester will deliver to the customer.

\subsection{Post-Exploitation}
This phase, in general, refers to all those steps and actions performed after the pentester managed to breach into the system, which could be different depending on the specific system compromised. Once a system has been compromised there are several paths that can be followed, for example an attacker could:
\begin{itemize}
    \item attempt to gain further access to internal network(s);
    \item setting up backdoors for future access;
    \item cover tracks and clean the logs.
\end{itemize}
In this phase the pentester is usually expected to fully restore compromised systems to their clean state so that he causes little to no harm to business processes involving that system.

\subsection{Reporting}
This is the last phase of the penetration testing and, as the name suggests, in this phase the pentester delivers a final report of the whole experiment to the client, containing also details about what has been done during the reconnaissance, modelling and exploiting phases like:
\begin{itemize}
    \item vulnerabilities, payloads, compromised machines;
    \item time spent in the process;
    \item hypothetical profit for an attacker.
\end{itemize}
In the final report are also reported the pentester's suggestions on how to make the system more robust and how to mitigate the vulnerabilities. It is expected that this report will be used by the customer as a guideline for future system hardening and tests.

\clearpage